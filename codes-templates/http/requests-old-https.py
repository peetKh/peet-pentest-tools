"""

Code template for connecting to old deprecated HTTPS servers.

This is COMPLETELY UNSECURE, but you know what you're doing..... right ?

""""


# OLD HTTPS TLSv1 session ======================================================

# print quoted response
def printq(s):
    print(' <|' + s.replace('\n','\n  | '))

# To avoid annoying warnings
requests.packages.urllib3.disable_warnings()

# To override SSL/TLS DH key minimum size
# Ref: https://stackoverflow.com/questions/38015537/python-requests-exceptions-sslerror-dh-key-too-small
requests.packages.urllib3.util.ssl_.DEFAULT_CIPHERS += 'HIGH:!DH:!aNULL'

# To override SSL/TLS minimum protocol version
# Ref: https://stackoverflow.com/questions/38501531/forcing-requests-library-to-use-tlsv1-1-or-tlsv1-2-in-python
from requests.adapters import HTTPAdapter
from requests.packages.urllib3.poolmanager import PoolManager
import ssl
class MyAdapter(HTTPAdapter):
     def init_poolmanager(self, connections, maxsize, block=False):
         self.poolmanager = PoolManager(num_pools=connections,
                                maxsize=maxsize,
                                block=block,
                                ssl_version=ssl.PROTOCOL_TLSv1)

s = requests.Session( )
s.verify  = False
s.headers['User-Agent'] = "Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:1.4) Gecko/20030624 Netscape/7.1 (ax)"
s.mount('https://', MyAdapter())

# ==============================================================================

s.get('https://tlsv1-host/')
