# Description #

This is a small proxy server for pivoting through a Windows machine. It works 
with both SOCKS 4 and SOCKS 5 protocols, but only implements a small part of it
(establish TCP/IP connection with no authentication).

Once compiled, it is a stand along file that should not retuire any runtime
lybrary or any installation. You can just upload the file and run it.

## WARNING ##

I haven't run extensive tests, so I don't know how reliable it is. But I managed
to run an RDP session through it.

# Reason #

I developped this SOCKS in order to have dynamic port forwarding 
to distant sub-networks by pivoting through a Windows machine.

So I wanted the smallest portable SOCKS proxy server running on Windows as
a standalone executable, without needing to install any runtime library,
or any other file.

There are other alternatives (see below) but either they didn't
fit my needs or, I didn't manage to use them properly.
I don't pretend my research to be exhaustive nor to be accurate.

It was also a good exercise to work with Windows sockets API.

# Other alternatives #

- plink/ssh port forwarding.
  
  No dynamic port forwarding unless an ssh server is running on the 
  Windows machine.
  AFAIK plink does not allows dynamic remote port forwarding and only
  "recent" versions of ssh do (if even installed).

- Proxy SOCKS 5 server in python
  https://raw.githubusercontent.com/rushter/socks5/master/server.py

  It's a Python script so it requires Python, which is not so common
  on Windows machines.
  Can use pyinstaller or such, but even though it provides a stand alone
  solution, it requires a bunch of files to work. I put them all in a
  zip but then I need to unzip them, which is not always so easy to 
  do on some old Windows on a reverse shell.

- https://github.com/jgaa/shinysocks

    VisualStudio and requires boost. Gave up while trying to have it 
    compiled correctly. I expect that it would require the VS runtime
    to be installed libraries.
    
- https://github.com/rofl0r/microsocks

  *nix oriented, I didn't tried to compile it on windows.
    
# Typical use #

Just upload the file and run it

To avoid being annoyed by firewalls, you can use ssh/plink to remote forward a port
from your Kali VM to the proxy server on localhost port 9090 on the 
Windows pivoting machine. Since the connection to the prozy would be through the
loopback interface, chances are it will work. 
And from there you'll have dynamic port forwarding.


